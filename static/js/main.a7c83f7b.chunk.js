(this["webpackJsonpminesweeper-risk"]=this["webpackJsonpminesweeper-risk"]||[]).push([[0],{17:function(t,e,a){},24:function(t,e,a){},25:function(t,e,a){},26:function(t,e,a){},28:function(t,e,a){},29:function(t,e,a){},31:function(t,e,a){"use strict";a.r(e);var n={};a.r(n),a.d(n,"get_row_size",(function(){return H})),a.d(n,"get_col_relative_to_grid",(function(){return K})),a.d(n,"get_col_size",(function(){return Q})),a.d(n,"forward_diagonal",(function(){return T})),a.d(n,"back_diagonal",(function(){return V})),a.d(n,"horizontal",(function(){return X})),a.d(n,"vertical",(function(){return Y})),a.d(n,"get_row_type",(function(){return Z}));var s=a(1),r=a.n(s),i=a(18),u=a.n(i),c=(a(24),a(25),a(14)),o=a(19),l=a(15),h=a(2),d=a(3),p=a(4),f=a(5),v=(a(26),a(17),0),b=1,j=2,m=2,g=3,k=4,O=0,y=1,x=0,_=1,w=2,C=0,S=1,q=2,N=a(0),M=function(t){Object(p.a)(a,t);var e=Object(f.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).type=t.type,n.row=t.row,n.col=t.col,n}return Object(d.a)(a,[{key:"square_content",value:function(){return this.props.game_state===q&&this.props.status===b&&this.type!==y?"\u274c":this.props.status===b?"\ud83d\udea9":this.props.status>=g?"\ud83d\udca3":this.props.game_state===q&&this.type===y?"\ud83d\udfe0":this.props.game_state===S&&this.type===y?"\ud83d\udfe1":""}},{key:"componentDidUpdate",value:function(){window.twemoji.parse(document.querySelector('.square[data-row="'.concat(this.row,'"][data-col="').concat(this.col,'"]')))}},{key:"render",value:function(){return Object(N.jsxs)("div",{className:"wrapper",children:[Object(N.jsx)("div",{className:"square"+(this.props.status>=j?" revealed":""),"data-row":this.row,"data-col":this.col,onClick:this.props.onClick,children:Object(N.jsx)("span",{children:this.square_content()})}),this.props.clues]})}}]),a}(r.a.Component),E=a(12),W=a.n(E),z=a(16),L=(a(28),function(t){Object(p.a)(a,t);var e=Object(f.a)(a);function a(){return Object(h.a)(this,a),e.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return Object(N.jsxs)("div",{className:"tool"+(this.props.active?" selected":""),onClick:this.props.onClick,children:[Object(N.jsx)("span",{className:"icon",children:this.props.icon}),Object(N.jsx)("span",{className:"count",children:this.props.value})]})}}]),a}(r.a.Component)),A=function(t){Object(p.a)(a,t);var e=Object(f.a)(a);function a(){return Object(h.a)(this,a),e.apply(this,arguments)}return Object(d.a)(a,[{key:"componentDidMount",value:function(){window.twemoji.parse(document.querySelector(".toolbox"))}},{key:"render",value:function(){return Object(N.jsx)("div",{className:"toolbox",children:this.props.tools.map((function(t){return Object(s.createElement)(L,Object(z.a)(Object(z.a)({},t),{},{key:t.type}))}))})}}]),a}(r.a.Component),D=a(8),G=(a(29),function(t){Object(p.a)(a,t);var e=Object(f.a)(a);function a(t){var n;return Object(h.a)(this,a),(n=e.call(this,t)).arrow=a.ARROWS[t.dir],n.value=n.props.value,n.set_percentage_value(),n.handleMouseOver=n.handleMouseOver.bind(Object(D.a)(n)),n.handleMouseLeave=n.handleMouseLeave.bind(Object(D.a)(n)),n}return Object(d.a)(a,[{key:"set_percentage_value",value:function(){this.percent=this.as_percentage(this.props.value,this.props.total)}},{key:"as_percentage",value:function(t,e){return(0===e?0:Number((t/e*100).toFixed(1)))+"%"}},{key:"handleMouseOver",value:function(t){t.target.textContent=this.percent}},{key:"handleMouseLeave",value:function(t){t.target.textContent=this.value}},{key:"componentDidUpdate",value:function(t){t.total!==this.props.total&&this.set_percentage_value()}},{key:"render",value:function(){return Object(N.jsxs)("div",{className:"clue "+this.props.dir,children:[Object(N.jsx)("span",{className:"clue__value",onMouseEnter:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,children:this.value}),Object(N.jsx)("span",{className:"clue__direction",children:this.arrow})]})}}]),a}(r.a.Component));G.ARROWS={N:"\u2191",NE:"\u2197",E:"\u2192",SE:"\u2198",S:"\u2193",SW:"\u2199",W:"\u2190",NW:"\u2196"};var I=G,R=a(6),B=a.n(R),J=B.a.mark(T),P=B.a.mark(V),U=B.a.mark(X),F=B.a.mark(Y);function H(t,e){return e>=t?4*t-2*e-3:2*e+1}function K(t,e,a){return(e>=t?e-t+1:t-1-e)+a}function Q(t,e,a){return H(t,K(t,e,a))}function T(t,e,a,n){var s,r,i,u,c,o;return B.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(s=(t.length-1)/2+1,r=K(s,e,a),0!==a){l.next=12;break}i=e,u=r;case 4:if(!(i>e-s)){l.next=10;break}return l.next=7,[i,n[i][u]];case 7:i--,u++,l.next=4;break;case 10:l.next=19;break;case 12:c=e,o=r;case 13:if(!(c<e+s)){l.next=19;break}return l.next=16,[c,n[c][o]];case 16:c++,o--,l.next=13;break;case 19:case"end":return l.stop()}}),J)}function V(t,e,a,n){var s,r,i,u,c,o;return B.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(s=(t.length-1)/2+1,r=K(s,e,a),!(e>=s-1)){l.next=12;break}i=e,u=r;case 4:if(!(i>e-s)){l.next=10;break}return l.next=7,[i,n[i][u]];case 7:i--,u--,l.next=4;break;case 10:l.next=19;break;case 12:c=e,o=r;case 13:if(!(c<e+s)){l.next=19;break}return l.next=16,[c,n[c][o]];case 16:c++,o++,l.next=13;break;case 19:case"end":return l.stop()}}),P)}function X(t,e){var a;return B.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=0;case 1:if(!(a<t[e].length)){n.next=7;break}return n.next=4,[e,a];case 4:a++,n.next=1;break;case 7:case"end":return n.stop()}}),U)}function Y(t,e,a,n){var s,r,i,u,c,o,l;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=K(n,e,a),r=H(n,s),i=Math.abs(n-1-s),u=s>=n?H(n,i)-1:0,c=i,o=u,l=0;case 5:if(!(l<r)){t.next=12;break}return t.next=8,[c,o];case 8:c>=n-1?o--:o++;case 9:l++,c++,t.next=5;break;case 12:case"end":return t.stop()}}),F)}function Z(t){switch(t){case"SE":case"NW":return"back_diagonal";case"NE":case"SW":return"forward_diagonal";case"N":case"S":return"vertical";default:return"horizontal"}}var $=function(t){Object(p.a)(a,t);var e=Object(f.a)(a);function a(){return Object(h.a)(this,a),e.apply(this,arguments)}return Object(d.a)(a,[{key:"refreshPage",value:function(){window.location.reload()}},{key:"render",value:function(){return Object(N.jsxs)("div",{style:{textAlign:"center"},children:[this.props.result,Object(N.jsx)("br",{}),Object(N.jsx)("button",{onClick:this.refreshPage,children:"Retry?"})]})}}]),a}(r.a.Component);var tt=function(t){Object(p.a)(a,t);var e=Object(f.a)(a);function a(t){var n;Object(h.a)(this,a),n=e.call(this,t);var s=t.size||4;n.size=s;var r=2*s-1,i=t.bomb_density||.3,u=Math.pow(s,2)+Math.pow(s-1,2);n.total_fields=u;var c=t.digs||2;return n.state={squares:Array(r).fill(null).map((function(t,e){return Array(H(s,e)).fill(null).map((function(t){return{type:Math.random()<i?y:O,status:v}}))})),current_game_status:C,tool:x,remaining:{}},n.state.remaining[w]=c,n.state.remaining[_]=n.state.squares.flat().filter((function(t){return t.type===y})).length,n.state.remaining[x]=u-n.state.remaining[_],n.grid_col_to_square_col=function(t){for(var e={},a=2*t-1,n=0;n<a;n++){var s=H(t,n);e[n]={};for(var r=0;r<s;r++)e[n][K(t,n,r)]=r}return e}(s),n}return Object(d.a)(a,[{key:"updateGameStatus",value:function(t,e){if(e.status===t.status)return!1;var a=this.state.remaining;return this.state.tool===w&&a[w]--,e.status>=j&&a[x]--,this.setState({remaining:a}),t.status===b&&e.status===v?a[_]++:(t.status===v&&e.status===b||e.status>=g)&&a[_]--,this.setState({remaining:a}),e.status===k?q:0===a[x]?S:C}},{key:"componentDidMount",value:function(){var t=this;document.addEventListener("contextmenu",(function(e){if(e.target.closest(".square")){e.preventDefault();var a=e.target.closest(".square").dataset;t.handleSquareClick(parseInt(a.row),parseInt(a.col),!0)}}),!0),document.addEventListener("auxclick",(function(e){var a=e.target.closest(".clue");if(a&&2===e.which){e.preventDefault();var n=a.parentElement.querySelector(".square").dataset;t.handleClueClick(parseInt(n.row),parseInt(n.col),Object(o.a)(Array,Object(l.a)(a.classList)).filter((function(t){return t.length<=2}))[0])}}),!0)}},{key:"handleSquareClick",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.state.current_game_status!==C)return!1;var n=this.state.tool===w;if(this.state.tool!==w&&a&&this.setState({tool:_}),this.state.tool!==_&&this.state.squares[t][e].status===b)return!1;this.updateSquare(t,e),this.state.tool===_&&this.setState({tool:n?w:x})}},{key:"updateSquare",value:function(t,e){var a=W()(this.state.squares),n=a[t][e],s=W()(n);s.status=function(t,e,a){if(t.status>=j)return t.status;switch(e){case _:return t.status===b?v:a[_]>0?b:t.status;case w:return a[w]>0?j+t.type:t.status;default:return t.type===O?m:k}}(n,this.state.tool,this.state.remaining);var r=this.updateGameStatus(n,s);!1!==r&&(a[t][e]=s,this.setState({squares:a,current_game_status:r}))}},{key:"toggleShovel",value:function(){this.setState({tool:this.state.tool===w?x:w})}},{key:"getCountBombGenerator",value:function(t,e,a){var s,r=Z(a);return"vertical"===r?s=this.size:"back_diagonal"!==r&&"forward_diagonal"!==r||(s=this.grid_col_to_square_col),n[r](this.state.squares,t,e,s)}},{key:"handleClueClick",value:function(t,e,a){var n,s=W()(this.state.squares),r=this.getCountBombGenerator(t,e,a),i=[],u=Object(c.a)(r);try{for(u.s();!(n=u.n()).done;){var o=n.value,h=s[o[0]][o[1]];if(h.type===y&&h.status!==b&&h.status<j)return;h.status===v&&i.push(o)}}catch(m){u.e(m)}finally{u.f()}for(var d=0,p=i;d<p.length;d++){var f=p[d];this.updateSquare.apply(this,Object(l.a)(f))}}},{key:"addClue",value:function(t,e,a,n){var s,r=this.getCountBombGenerator(a,n,e),i=0,u=0,o=Object(c.a)(r);try{for(o.s();!(s=o.n()).done;){var l=s.value,h=this.state.squares[l[0]][l[1]];i+=h.type,u+=h.status===m?0:1}}catch(d){o.e(d)}finally{o.f()}t.push(Object(N.jsx)(I,{dir:e,value:i,total:u},[e,a,n].join("-")))}},{key:"display_clues",value:function(t,e){var a=this.size,n=2*a-1,s=H(a,t),r=Q(a,t,e),i=Math.floor(a/2),u=Math.floor(n/2),c=[];return t<i&&0===e?this.addClue(c,"SE",t,e):t>=n-i&&e===s-1&&this.addClue(c,"NW",t,e),t>i&&t<n-i&&0===e?this.addClue(c,"NE",t,e):t<a&&t>=i&&e===s-1&&this.addClue(c,"SW",t,e),r>=Math.max(3,u-n%2)&&(t>i&&0===e&&t!==n-1?this.addClue(c,"N",t,e):t<n-i-1&&e===s-1&&this.addClue(c,"S",t,e)),s>=Math.max(3,u-n%2)&&(t>i+1&&e===s-1&&0!==e?this.addClue(c,"W",t,e):t<n-i-1&&0===e&&this.addClue(c,"E",t,e)),c}},{key:"render",value:function(){var t=this,e=[{type:"shovel",icon:"\u26cf\ufe0f",value:this.state.remaining[w],active:this.state.tool===w,onClick:this.toggleShovel.bind(this)},{type:"flag",icon:"\ud83d\udea9",value:this.state.remaining[_]}];return Object(N.jsxs)("div",{className:"board",children:[Object(N.jsx)(A,{tools:e}),Object(N.jsx)("div",{className:"grid",children:this.state.squares.map((function(e,a){return Object(N.jsx)("div",{className:"row",children:e.map((function(e,n){return Object(N.jsx)(M,{type:e.type,status:e.status,game_state:t.state.current_game_status,row:a,col:n,clues:t.display_clues(a,n),onClick:t.handleSquareClick.bind(t,a,n,!1)},a+","+n)}))},a)}))}),this.state.current_game_status===q?Object(N.jsx)($,{result:"loss"}):"",this.state.current_game_status===S?Object(N.jsx)($,{result:"win"}):""]})}}]),a}(r.a.Component);var et=function(){return Object(N.jsx)(tt,{size:"4"})};u.a.render(Object(N.jsx)(r.a.StrictMode,{children:Object(N.jsx)(et,{})}),document.getElementById("game"))}},[[31,1,2]]]);
//# sourceMappingURL=main.a7c83f7b.chunk.js.map